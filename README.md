тихая установка агента:
	msiexec /i c:\windows\temp\grb.x32.msi /l C:\windows\temp\l.log /quiet /norestart

удаление агента:
	powershell.exe 	
	(Get-WmiObject -Class Win32_Product -Filter "Name = 'TeleLinkSoftHelper'").Uninstall()
	
	
	
Данная программа является очень простым мониторингом хождения почты между указанными доменами. 
Программа посылает письмо на домен и ждёт определённого обратного письма. Если обратное письмо не приходит, посылает уведомление в телеграм-канал.
Оба сервера, отправителя и получателя требуют настройки. 
На отправителе надо настроить лишь анти-спам фильтр, чтобы обратные письма не фильтровались.
На получателе надо добавить две вещи: 
  1. исключение в антиспам
  2. правило, чтобы сервер пересылал сообщение обратно, добавляя в его тему указанный префикс
  
Аргументы для запуска программы с примером:

--fromMailbox monitor_1@domain.com
почтовый ящик отправителя

--fromMailboxPass TV237Pgq7NdsXgoJq
пароль к почтовому ящику отправителя

--smtpServer smtp.domain.com
сервер отправителя, для отправки писем

--imapServer imap.domain.com
сервер отправителя, для проверки обратного письма

--toMailbox monitor@company.org
почтовый ящик получателя

--botToken 333218399:AAHWEvJ2orVht5vFjikdjszRwhvBEBs6a0c
токен телеграм-бота, который будет слать уведомления в случае неполучения обратного письма

--botChatId -321013329
идентификатор чата, в который будут слаться уведомления. У бота должна быть включена работа в группах и иногда приходится делать его админом группы

--subjectCode receivedJKO
префикс, который добавляется к теме письма перед отправкой обратного письма получателем

--alarmTimeout 10
если обратное письмо не получено в течение данного количества минут, бот пошлёт уведомление

--cycleInterval 3
после успешного получения обратного письма, бот ожидаем это количество минут, прежде чем отправить новое письмо


Механика работы программы в соответствии с аргументами выше:
1. Программа с почтового ящика monitor_1@domain.com, используя пароль TV237Pgq7NdsXgoJq и сервер smtp.domain.com отправляет письмо на ящик monitor@company.org (в теме код из цифр, каждый раз разный)
2. Почтовый сервер monitor@company.org, руководствуясь заранее настроенным правилом, добавляет в тему письма префикс receivedJKO и отправляет это же письмо обратно отправителю
3. Программа подключается к почтовому ящику monitor_1@domain.com, используя пароль TV237Pgq7NdsXgoJq и сервер imap.domain.com и проверяет наличие там письма с кодом из цифр и префиксом receivedJKO
4. Если такое письмо находится - программа ждёт 3 минуты перед отправкой следующего письма.
5. Если за 10 минут обратное письмо так и не пришло, программа посылает уведомление через бота с токеном 333218399:AAHWEvJ2orVht5vFjikdjszRwhvBEBs6a0c в чат -321013329 и отправляет новое письмо.
